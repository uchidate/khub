name: ðŸ” Debug Env

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Debug Env File
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            cd /var/www/hallyuhub
            echo "ðŸ“‚ Listing files:"
            ls -la
            echo "--------------------------------"
            echo "â“ Checking .env.production keys:"
            grep -o '^[^=]*' .env.production || echo "Grep failed or file empty"
            echo "--------------------------------"
            echo "â“ Checking DATABASE_URL value (masked):"
            grep "DATABASE_URL" .env.production | sed 's/DATABASE_URL=.*/DATABASE_URL=******/' || echo "DATABASE_URL not found"
            echo "--------------------------------"
            echo "â“ Checking DATABASE_URL raw length:"
            grep "DATABASE_URL" .env.production | awk -F= '{print length($2)}' || echo "0"
            echo "--------------------------------"
            echo "â“ Checking .env.production.bak:"
            ls -la .env.production.bak 2>/dev/null || echo "No backup found"
