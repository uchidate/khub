name: ü§ñ Run Content Automation

on:
  workflow_dispatch:

jobs:
  trigger-automation:
    name: ü§ñ Run Generation Script
    runs-on: ubuntu-latest
    
    steps:
      - name: Execute on Server via SSH
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            echo "üöÄ Iniciando automa√ß√£o manual..."
            cd /var/www/hallyuhub
            
            # Garantir permiss√µes
            chmod +x scripts/auto-generate-content.sh
            
            # Executar script
            export NODE_ENV=production
            ./scripts/auto-generate-content.sh
            
            # Mostrar o log gerado para confirma√ß√£o visual
            TODAY=$(date +%Y-%m)
            LOG_FILE="logs/auto-generate-$TODAY.log"
            
            echo "üìÑ Conte√∫do do log ($LOG_FILE):"
            echo "---------------------------------------------------"
            if [ -f "$LOG_FILE" ]; then
              cat "$LOG_FILE"
            else
              echo "‚ùå Log file not found: $LOG_FILE"
            fi
            echo "---------------------------------------------------"
            
            echo "‚úÖ Execu√ß√£o finalizada."
